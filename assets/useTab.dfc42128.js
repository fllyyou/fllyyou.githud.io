var c=Object.defineProperty;var v=(s,t,e)=>t in s?c(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var r=(s,t,e)=>(v(s,typeof t!="symbol"?t+"":t,e),e);import{C as m,r as a}from"./index.03bfe113.js";import{p as y}from"./@vueuse.954f3924.js";import{r as u,n as d,f as l}from"./@vue.e6dedf64.js";class f{constructor(){r(this,"history",y(m.HISTORY_MENU,[]));r(this,"route",u(null));r(this,"isRouterAlive",u(!0));this.history.value=this.getHistoryTab()}removeHistoryTab(t){const e=this.history.value.indexOf(t);this.history.value.splice(e,1)}addHistoryTab(t){var o,h;if(!((o=t.meta)!=null&&o.menu))return;this.route.value=t;const e={...(h=t.meta)==null?void 0:h.menu,route:t.name};this.history.value.some(n=>n.route==t.name)||this.history.value.unshift(e),this.history.value.length>10&&this.history.value.pop()}reload(){this.isRouterAlive.value=!1,d(()=>{this.isRouterAlive.value=!0})}closeSelf(){const t=this.history.value.find(i=>{var o;return i.route==((o=this.route.value)==null?void 0:o.name)}),e=this.history.value.length;if(t&&e>1){this.removeHistoryTab(t);const i=this.history.value[e-2];a.push({name:i.route})}}calcalateHistoryIndex(){return this.history.value.findIndex(t=>{var e;return t.route==((e=this.route.value)==null?void 0:e.name)})}isTop(){return l(()=>this.calcalateHistoryIndex()===0)}isBottom(){return l(()=>{const t=this.history.value.length;return this.calcalateHistoryIndex()===t-1})}closeLeft(){if(!this.isTop().value){const t=this.calcalateHistoryIndex();this.history.value.splice(0,t)}}closeRight(){if(!this.isBottom().value){const t=this.calcalateHistoryIndex();this.history.value.splice(t+1)}}closeOther(){this.closeLeft(),this.closeRight()}closeAll(){a.push("/"),this.history.value=[{route:"Dashboard",title:"router.dashboard"}]}closeCurrent(){var t;this.removeHistoryTab({route:(t=a.currentRoute.value.name)==null?void 0:t.toString()})}getHistoryTab(){const t=[];return a.getRoutes().map(e=>t.push(...e.children)),this.history.value.filter(e=>t.some(i=>i.name==e.route))}}const T=new f;export{T as t};
